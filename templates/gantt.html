{% extends "base.html" %}
{% block content %}
<h1>Vista Gantt</h1>
<div id="gantt_container" class="gantt-container"></div>
<style>
  .gantt-container {
    position: relative;
    width: 100%;
    border: 1px solid #ccc;
    background: #fafafa;
  }
  .gantt-task {
    position: absolute;
    height: 20px;
    background: #3a87ad;
    color: #fff;
    font-size: 12px;
    overflow: hidden;
    white-space: nowrap;
    padding: 0 4px;
    box-sizing: border-box;
    border-radius: 2px;
  }
</style>
<script>
  const tasks = {{ tasks|safe }};
  if (tasks.length) {
    const container = document.getElementById('gantt_container');
    const starts = tasks.map(t => new Date(t.start).getTime());
    const ends = tasks.map(t => new Date(t.end).getTime());
    const minStart = Math.min(...starts);
    const maxEnd = Math.max(...ends);
    const range = maxEnd - minStart;
    container.style.height = (tasks.length * 24) + 'px';
    tasks.forEach((t, i) => {
      const s = new Date(t.start).getTime();
      const e = new Date(t.end).getTime();
      const task = document.createElement('div');
      task.className = 'gantt-task';
      task.style.top = (i * 24) + 'px';
      task.style.left = ((s - minStart) / range * 100) + '%';
      task.style.width = ((e - s) / range * 100) + '%';
      task.textContent = t.name;
      container.appendChild(task);
    });
  }
</script>
{% endblock %}
